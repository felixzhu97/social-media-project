@startuml
!include ./c4-plantuml//C4_Component.puml

LAYOUT_WITH_LEGEND()

' 组件图 - Web应用
Container_Boundary(web_app, "Web应用") {
    Component(home_feed, "首页Feed", "Next.js Page", "展示关注用户的帖子")
    Component(explore_page, "发现页", "Next.js Page", "发现新内容")
    Component(post_page, "帖子页", "Next.js Page", "查看和互动帖子")
    Component(post_editor, "帖子编辑器", "React Component", "创建/编辑帖子")
    Component(comment_section, "评论区", "React Component", "显示和管理评论")
    Component(like_button, "点赞按钮", "React Component", "处理点赞交互")
    Component(share_button, "分享按钮", "React Component", "处理分享功能")
    Component(save_button, "收藏按钮", "React Component", "处理收藏功能")
    Component(reels_page, "短视频页", "Next.js Page", "浏览短视频内容")
    Component(reels_player, "短视频播放器", "React Component", "播放短视频")
    Component(story_page, "故事页", "Next.js Page", "查看24小时故事")
    Component(story_viewer, "故事查看器", "React Component", "播放故事内容")
    Component(messages_page, "消息页", "Next.js Page", "私信功能")
    Component(chat_interface, "聊天界面", "React Component", "实时消息交互")
    Component(notifications_page, "通知页", "Next.js Page", "查看通知")
    Component(notification_bell, "通知铃", "React Component", "显示未读通知")
    Component(profile_page, "个人主页", "Next.js Page", "用户个人资料")
    Component(profile_editor, "资料编辑器", "React Component", "编辑个人资料")
    Component(login_page, "登录页", "Next.js Page", "用户登录")
    Component(register_page, "注册页", "Next.js Page", "用户注册")
    Component(search_page, "搜索页", "Next.js Page", "搜索用户和内容")
    Component(trending_tags, "热门标签", "React Component", "显示热门话题")
    Component(follow_button, "关注按钮", "React Component", "处理关注关系")
    Component(analytics_dashboard, "分析面板", "React Component", "显示内容表现")
}

' 组件图 - API服务
Container_Boundary(api, "API服务") {
    Component(deployment_service, "部署服务", "TypeScript", "处理容器部署")
    Component(scaling_service, "扩缩容服务", "TypeScript", "管理容器实例数量")
    Component(monitoring_service, "监控服务", "TypeScript", "收集容器指标")
    Component(auth_route, "认证路由", "Express Router", "处理认证相关请求")
    Component(users_route, "用户路由", "Express Router", "处理用户相关请求")
    Component(posts_route, "帖子路由", "Express Router", "处理帖子相关请求")
    Component(comments_route, "评论路由", "Express Router", "处理评论请求")
    Component(interactions_route, "互动路由", "Express Router", "处理点赞/收藏/分享")
    Component(reels_route, "短视频路由", "Express Router", "处理短视频相关请求")
    Component(stories_route, "故事路由", "Express Router", "处理故事相关请求")
    Component(relationships_route, "关系路由", "Express Router", "处理关注/粉丝")
    Component(messages_route, "消息路由", "Express Router", "处理消息相关请求")
    Component(notifications_route, "通知路由", "Express Router", "处理通知相关请求")
    Component(search_route, "搜索路由", "Express Router", "处理搜索请求")
    Component(analytics_route, "分析路由", "Express Router", "处理分析数据请求")

    Component(auth_controller, "认证控制器", "TypeScript", "处理认证和授权")
    Component(user_controller, "用户控制器", "TypeScript", "处理用户业务逻辑")
    Component(post_controller, "帖子控制器", "TypeScript", "处理帖子业务逻辑")
    Component(comment_controller, "评论控制器", "TypeScript", "处理评论业务逻辑")
    Component(interaction_controller, "互动控制器", "TypeScript", "处理互动业务逻辑")
    Component(reel_controller, "短视频控制器", "TypeScript", "处理短视频业务逻辑")
    Component(story_controller, "故事控制器", "TypeScript", "处理故事业务逻辑")
    Component(relationship_controller, "关系控制器", "TypeScript", "处理关注关系")
    Component(message_controller, "消息控制器", "TypeScript", "处理消息业务逻辑")
    Component(notification_controller, "通知控制器", "TypeScript", "处理通知业务逻辑")
    Component(search_controller, "搜索控制器", "TypeScript", "处理搜索逻辑")
    Component(analytics_controller, "分析控制器", "TypeScript", "处理分析逻辑")

    Component(user_model, "用户模型", "TypeORM", "用户数据模型")
    Component(post_model, "帖子模型", "TypeORM", "帖子数据模型")
    Component(comment_model, "评论模型", "TypeORM", "评论数据模型")
    Component(interaction_model, "互动模型", "TypeORM", "互动数据模型")
    Component(relationship_model, "关系模型", "TypeORM", "关注关系模型")
    Component(message_model, "消息模型", "Cassandra", "消息数据模型")
    Component(log_model, "日志模型", "Cassandra", "日志数据模型")
    Component(session_model, "会话模型", "Redis", "管理用户会话")
    Component(cache_model, "缓存模型", "Redis", "处理实时数据缓存")
}

' 组件关系
Rel(home_feed, posts_route, "获取帖子", "HTTPS")
Rel(explore_page, posts_route, "发现内容", "HTTPS")
Rel(post_page, posts_route, "获取帖子详情", "HTTPS")
Rel(post_editor, posts_route, "创建/更新帖子", "HTTPS")
Rel(comment_section, comments_route, "获取/提交评论", "HTTPS")
Rel(like_button, interactions_route, "点赞/取消", "HTTPS")
Rel(share_button, interactions_route, "分享内容", "HTTPS")
Rel(save_button, interactions_route, "收藏/取消", "HTTPS")
Rel(reels_page, reels_route, "获取短视频", "HTTPS")
Rel(reels_player, reels_route, "播放/互动", "HTTPS")
Rel(profile_page, users_route, "获取用户资料", "HTTPS")
Rel(follow_button, relationships_route, "关注/取关", "HTTPS")
Rel(analytics_dashboard, analytics_route, "获取分析数据", "HTTPS")
Rel(deployment_service, docker, "部署容器", "Docker API")
Rel(scaling_service, k8s, "管理容器", "Kubernetes API")
Rel(monitoring_service, k8s, "获取指标", "Kubernetes API")
Rel(auth_controller, session_model, "管理会话", "Redis")
Rel(interaction_controller, cache_model, "缓存互动数据", "Redis")

@enduml
